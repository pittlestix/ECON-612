---
title: "Exam 1 Results and Statistics"
output: html_document
---

```{r Installing Packages, include = FALSE}
options(stringsAsFactors = FALSE)
install.packages("here", repos = "http://cran.us.r-project.org")
library(here)
install.packages("xts", repos = "http://cran.us.r-project.org")
library(xts)
install.packages("zoo", repos = "http://cran.us.r-project.org")
library(zoo)
install.packages("ggplot2", repos = "http://cran.us.r-project.org")
library(ggplot2)
install.packages("knitr", repos = "http://cran.us.r-project.org")
library(knitr) # for tables (kable function)
```

```{r IMPORT: Grades, include = FALSE}
data_cnv <- read.csv(here("./src/routes/(full-website)/exam-1/Data/Gradebook_Sep_20.csv")) # nolint
data_cnv <- data_cnv[-1, ] # Removing Possible Points row
data_cnv <- data_cnv[-61, ] # Removing Test Student
data_cnv <- data_cnv[, -2] # Removing ID column
data_cnv <- data_cnv[-c(3:7)]
data_cnv <- data_cnv[-c(5:6)]
data_cnv <- data_cnv[-6]
data_cnv <- data_cnv[-c(7:ncol(data_cnv))]

# Calculating bonus points
for (i in nrow(data_cnv):1) {
    data_cnv[i, 7] <- (data_cnv[i, 3] + data_cnv[i, 4] + data_cnv[i, 5] + data_cnv[i, 6])
}
data_cnv <- data_cnv[-c(3:6)]
colnames(data_cnv) <- c("Name", "UIN", "EC")
rownames(data_cnv) <- c(1:60)
```

```{r CREATE: Grades, include = FALSE}
data_cnv[1, c(4:12)] <- c(2, 2, 4, 2, 2, 0, 2, 2.5, 0)
data_cnv[2, c(4:12)] <- c(2, 0, 4, 2, 0, 1, 1, 0, 0)
data_cnv[3, c(4:12)] <- c(2, 0, 2, 0, 0, 2, 2, 0, 0)
data_cnv[4, c(4:12)] <- c(2, 0, 2, 0, 3, 1, 3, 0, 0)
data_cnv[5, c(4:12)] <- c(0, 2, 2, 0, 0, 0, 2, 0, 0)
data_cnv[6, c(4:12)] <- c(8, 4, 6, 0, 2, 2, 7, 2.5, 0)
data_cnv[7, c(4:12)] <- c(0, 6, 2, 0, 0, 1, 5, 5, 0)
data_cnv[8, c(4:12)] <- c(4, 4, 0, 0, 8, 1, 6, 0, 0)
data_cnv[9, c(4:12)] <- c(2, 0, 2, 0, 0, 1, 2, 2.5, 0)
data_cnv[10, c(4:12)] <- c(4, 0, 2, 2, 3, 0, 5, 5, 0)
data_cnv[11, c(4:12)] <- c(2, 4, 8, 0, 2, 0, 5, 0, 5)
data_cnv[12, c(4:12)] <- c(4, 2, 2, 0, 5, 1, 3, 2.5, 0)
data_cnv[13, c(4:12)] <- c(2, 4, 4, 2, 7, 1, 3, 0, 0)
data_cnv[14, c(4:12)] <- c(2, 2, 2, 0, 0, 0, 2, 0, 5)
data_cnv[15, c(4:12)] <- c(2, 6, 4, 2, 4, 1, 5, 2.5, 0)
data_cnv[16, c(4:12)] <- c(2, 2, 2, 0, 2, 1, 4, 2.5, 0)
data_cnv[17, c(4:12)] <- c(4, 4, 6, 0, 0, 2, 3, 2.5, 0)
data_cnv[18, c(4:12)] <- c(4, 0, 2, 0, 0, 1, 4, 0, 0)
data_cnv[19, c(4:12)] <- c(4, 2, 4, 2, 2, 1, 1, 0, 5)
data_cnv[20, c(4:12)] <- c(4, 2, 2, 6, 2, 1, 5, 5, 0)
data_cnv[21, c(4:12)] <- c(2, 0, 2, 0, 6, 1, 3, 2.5, 0)
data_cnv[22, c(4:12)] <- c(2, 2, 4, 2, 4, 1, 5, 0, 0)
# data_cnv[23, c(4:12)] <- c()
data_cnv[24, c(4:12)] <- c(2, 2, 0, 0, 0, 1, 4, 2.5, 0)
data_cnv[25, c(4:12)] <- c(4, 4, 4, 2, 4, 1, 3, 0, 0)
data_cnv[26, c(4:12)] <- c(6, 2, 4, 0, 3, 1, 5, 2.5, 0)
data_cnv[27, c(4:12)] <- c(2, 4, 0, 2, 3, 1, 4, 0, 0)
data_cnv[28, c(4:12)] <- c(0, 0, 0, 0, 4, 1, 4, 2.5, 0)
data_cnv[29, c(4:12)] <- c(2, 2, 2, 4, 2, 1, 3, 0, 0)
data_cnv[30, c(4:12)] <- c(0, 4, 2, 0, 0, 0, 2, 0, 5)
data_cnv[31, c(4:12)] <- c(2, 2, 2, 0, 0, 1, 1, 2.5, 0)
data_cnv[32, c(4:12)] <- c(2, 6, 2, 2, 0, 1, 3, 0, 5)
data_cnv[33, c(4:12)] <- c(4, 4, 2, 0, 4, 1, 4, 2.5, 0)
data_cnv[34, c(4:12)] <- c(2, 0, 4, 0, 3, 1, 3, 0, 0)
data_cnv[35, c(4:12)] <- c(0, 0, 2, 0, 2, 1, 2, 1, 0)
data_cnv[36, c(4:12)] <- c(4, 4, 5, 4, 4, 1, 3, 0, 5)
data_cnv[37, c(4:12)] <- c(2, 0, 2, 0, 2, 0, 4, 0, 0)
data_cnv[38, c(4:12)] <- c(0, 0, 2, 0, 3, 0, 1, 0, 0)
data_cnv[39, c(4:12)] <- c(2, 4, 4, 0, 0, 6, 4, 2.5, 0)
data_cnv[40, c(4:12)] <- c(2, 8, 2, 0, 2, 0, 2, 0, 0)
data_cnv[41, c(4:12)] <- c(0, 4, 2, 0, 8, 1, 5, 0, 0)
data_cnv[42, c(4:12)] <- c(4, 8, 0, 0, 5, 2, 5, 5, 0)
data_cnv[43, c(4:12)] <- c(0, 4, 2, 0, 2, 0, 1, 2.5, 0)
data_cnv[44, c(4:12)] <- c(0, 4, 4, 2, 2, 1, 5, 0, 0)
data_cnv[45, c(4:12)] <- c(2, 2, 4, 0, 3, 1, 2, 0, 0)
data_cnv[46, c(4:12)] <- c(0, 4, 2, 4, 4, 1, 5, 0, 0)
data_cnv[47, c(4:12)] <- c(6, 0, 4, 0, 2, 1, 2, 0, 5)
data_cnv[48, c(4:12)] <- c(2, 6, 2, 0, 0, 1, 2, 2.5, 0)
data_cnv[49, c(4:12)] <- c(4, 2, 2, 0, 3, 1, 2, 0, 5)
data_cnv[50, c(4:12)] <- c(0, 0, 2, 0, 0, 1, 2, 0, 0)
data_cnv[51, c(4:12)] <- c(0, 4, 6, 2, 2, 0, 5, 5, 0)
data_cnv[52, c(4:12)] <- c(2, 2, 2, 0, 0, 0, 4, 1, 0)
data_cnv[53, c(4:12)] <- c(2, 8, 4, 0, 2, 1, 5, 0, 5)
data_cnv[54, c(4:12)] <- c(4, 8, 2, 2, 3, 1, 3, 0, 0)
data_cnv[55, c(4:12)] <- c(0, 2, 2, 4, 0, 1, 4, 0, 0)
data_cnv[56, c(4:12)] <- c(2, 4, 2, 0, 3, 1, 1, 0, 5)
data_cnv[57, c(4:12)] <- c(0, 2, 6, 0, 0, 1, 2, 0, 0)
data_cnv[58, c(4:12)] <- c(0, 4, 4, 0, 4, 2, 5, 3.5, 0)
data_cnv[59, c(4:12)] <- c(0, 8, 6, 0, 3, 2, 4, 2.5, 0)
data_cnv[60, c(4:12)] <- c(0, 2, 2, 0, 0, 1, 2, 2.5, 0)

for (i in nrow(data_cnv):1) {
    data_cnv[i, 13] <- (100 - data_cnv[i, 4] - data_cnv[i, 5] - data_cnv[i, 6] - data_cnv[i, 7] - data_cnv[i, 8] - data_cnv[i, 9] - data_cnv[i, 10] - data_cnv[i, 11] + data_cnv[i, 12])
    data_cnv[i, 14] <- (data_cnv[i, 3] + 100 - data_cnv[i, 4] - data_cnv[i, 5] - data_cnv[i, 6] - data_cnv[i, 7] - data_cnv[i, 8] - data_cnv[i, 9] - data_cnv[i, 10] - data_cnv[i, 11] + data_cnv[i, 12])
}

colnames(data_cnv) <- c("Name", "UIN", "EC", "P1", "P2", "P3", "P4", "P5", "P6", "P7", "P8", "Bonus", "Raw", "Final")

# View(data_cnv)
```

```{r CREATE: Missed Questions, include = FALSE}
data_mis <- matrix(NA, ncol = 1, nrow = 52)

# Page 1 True/False
data_mis[1, ] <- 32
data_mis[2, ] <- 11
data_mis[3, ] <- 0
data_mis[4, ] <- 5
data_mis[5, ] <- 12
data_mis[6, ] <- 22

# Page 2 True/False
data_mis[7, ] <- 20
data_mis[8, ] <- 0
data_mis[9, ] <- 18
data_mis[10, ] <- 13
data_mis[11, ] <- 12
data_mis[12, ] <- 11
data_mis[13, ] <- 2
data_mis[14, ] <- 9
data_mis[15, ] <- 1

# Page 3 Multiple Choice
data_mis[16, ] <- 1
data_mis[17, ] <- 13
data_mis[18, ] <- 12
data_mis[19, ] <- 15
data_mis[20, ] <- 45

# Page 4 Multiple Choice
data_mis[21, ] <- 6
data_mis[22, ] <- 4
data_mis[23, ] <- 2
data_mis[24, ] <- 10
data_mis[25, ] <- 2

# Page 5 Matching Part 1
data_mis[26, ] <- 0
data_mis[27, ] <- 0
data_mis[28, ] <- 3
data_mis[29, ] <- 0
data_mis[30, ] <- 0
data_mis[31, ] <- 0
data_mis[32, ] <- 0
data_mis[33, ] <- 3
data_mis[34, ] <- 0

# Page 5 Matching Part 2
data_mis[35, ] <- 4
data_mis[36, ] <- 24
data_mis[37, ] <- 8
data_mis[38, ] <- 2
data_mis[39, ] <- 27
data_mis[40, ] <- 17
data_mis[41, ] <- 24
data_mis[42, ] <- 17
data_mis[43, ] <- 3
data_mis[44, ] <- 1

# The following sections measure instances of partial/no credit.

# Page 6 Cost Evaluation
data_mis[45, ] <- 1
data_mis[46, ] <- 2
data_mis[47, ] <- 45

# Page 7 Adverse Selection
data_mis[48, ] <- 49
data_mis[49, ] <- 43
data_mis[50, ] <- 43

# Page 8 Essay & Bonus
data_mis[51, ] <- 26
data_mis[52, ] <- 48
```

```{r CREATE: Turn-in Times, include = FALSE}
data_all <- data_cnv[-c(2:12)]

data_all[1, 4] <- 69 # nice
data_all[2, 4] <- 72
data_all[3, 4] <- 45
data_all[4, 4] <- 78
data_all[5, 4] <- 69
data_all[6, 4] <- 67
data_all[7, 4] <- 39
data_all[8, 4] <- 59
data_all[9, 4] <- 79
data_all[10, 4] <- 43
data_all[11, 4] <- 55
data_all[12, 4] <- 71
data_all[13, 4] <- 89
data_all[14, 4] <- 73
data_all[15, 4] <- 55
data_all[16, 4] <- 84
data_all[17, 4] <- 50
data_all[18, 4] <- 89
data_all[19, 4] <- 51
data_all[20, 4] <- 46
data_all[21, 4] <- 75
data_all[22, 4] <- 72
# data_all[23, 4] <- didn't take exam
data_all[24, 4] <- 89
data_all[25, 4] <- 67
data_all[26, 4] <- 80
data_all[27, 4] <- 83
data_all[28, 4] <- 36
data_all[29, 4] <- 70
data_all[30, 4] <- 82
data_all[31, 4] <- 56
data_all[32, 4] <- 82
# data_all[33, 4] <- not collected
data_all[34, 4] <- 51
data_all[35, 4] <- 60
data_all[36, 4] <- 58
data_all[37, 4] <- 74
data_all[38, 4] <- 82
data_all[39, 4] <- 45
data_all[40, 4] <- 76
data_all[41, 4] <- 82
data_all[42, 4] <- 53
data_all[43, 4] <- 61
data_all[44, 4] <- 89
data_all[45, 4] <- 89
data_all[46, 4] <- 89
data_all[47, 4] <- 66
data_all[48, 4] <- 85
data_all[49, 4] <- 41
data_all[50, 4] <- 59
data_all[51, 4] <- 82
data_all[52, 4] <- 77
data_all[53, 4] <- 80
data_all[54, 4] <- 85
data_all[55, 4] <- 87
data_all[56, 4] <- 50
data_all[57, 4] <- 67
data_all[58, 4] <- 42
data_all[59, 4] <- 79
data_all[60, 4] <- 53

# View(data_all)
```

## Descriptive Statistics

```{r VALUES: Descriptive Statistics, include = FALSE}
val_raw_avg <- round(colMeans(data_all[2], na.rm = TRUE), digits = 1)
val_raw_obs <- round(sum(!is.na(data_all[2])), digits = 1)
val_fin_avg <- round(colMeans(data_all[3], na.rm = TRUE), digits = 1)
val_fin_obs <- round(sum(!is.na(data_all[3])), digits = 1)
```

The first exam was taken by `r val_fin_obs` students. The raw score average (without extra credit) was `r val_raw_avg` and the final score average (with extra credit) was `r val_fin_avg`.

The figure below plots the frequency distribution of raw scores. Raw scores are a measure of exam performance.

```{r PLOT: Grade Distribution, include = TRUE, echo = FALSE}
# Creating data for plot
plot_grd_raw <- matrix(1, nrow = nrow(data_all), ncol = 2)

for (i in nrow(plot_grd_raw):1) {
    plot_grd_raw[i, 1] <- data_all[i, 2]
}

plot_grd_raw <- plot_grd_raw[order(plot_grd_raw[, 1]), ]

plot_grd_raw_obs <- unique(plot_grd_raw)

for (i in nrow(plot_grd_raw_obs):1) {
    plot_grd_raw_obs[i, 2] <- sum(plot_grd_raw[1:val_raw_obs, 1] == plot_grd_raw_obs[i, 1])
}

plot_grd_raw <- data.frame(
    Score = plot_grd_raw_obs[1:32, 1],
    Obs = plot_grd_raw_obs[1:32, 2]
)

# De-Cluttering the Global Environment
rm(plot_grd_raw_obs)

# Making the plot
ggplot(plot_grd_raw, aes(x = factor(plot_grd_raw[, 1]), y = factor(plot_grd_raw[, 2]), fill = factor(plot_grd_raw[, 1]))) +
    geom_bar(stat = "identity") +
    ggtitle("Grade Distribution (Raw)") +
    ggeasy::easy_center_title() +
    theme(aspect.ratio = 5.25 / 7.5, legend.position = "none", axis.text.x = element_text(size = 4)) +
    scale_fill_manual(values = c("#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848", "#484848")) +
    xlab("Question") +
    ylab("Number of Instances")
```

## Most Missed Questions

Below is a bar graph depicting the number of instances a question was missed/not asnwered fully correctly. The bars are arranged from left to right by question order. Each section of the exam has its own color:

* The True/False questions are plotted in <b><span style = "color: #bf1818">red</span></b>.
* The Multiple Choice questions are plotted in <b><span style = "color: #e4770b">orange</span></b>.
* The Matching questions are plotted in <b><span style = "color: #ffe600">yellow</span></b>.
* The Cost Evaluation problem is plotted in <b><span style = "color: #1c7a1c">green</span></b>.
* The Adverse Selection problem is plotted in <b><span style = "color: #348bcd">blue</span></b>.
* The Essay and Bonus questions are plotted in <b><span style = "color: #6a308e">purple</span></b>.
* Questions that have been voided are plotted in <b><span style = "color: #868686">gray</span></b>.

```{r PLOT: Missed Questions, include = TRUE, echo = FALSE}
# Creating plot
plot_data_mis <- data.frame(
    qID = c(1:52),
    mis = data_mis[, 1],
    col = c(
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#868686",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#bf1818",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#e4770b",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#ffe600",
        "#1c7a1c",
        "#1c7a1c",
        "#1c7a1c",
        "#348bcd",
        "#348bcd",
        "#348bcd",
        "#6a308e",
        "#6a308e"
    )
)

ggplot(plot_data_mis, aes(x = factor(plot_data_mis[, 1]), y = factor(plot_data_mis[, 2]), fill = factor(plot_data_mis[, 1]))) +
    geom_bar(stat = "identity") +
    geom_hline(yintercept = 17) +
    ggtitle("Instances of No or Partial Credit") +
    ggeasy::easy_center_title() +
    theme(aspect.ratio = 5.25 / 7.5, legend.position = "none", axis.text.x = element_text(size = 4)) +
    scale_fill_manual(values = plot_data_mis[, 3]) +
    xlab("Question") +
    ylab("Number of Instances")
```

#### Summary

Below is a list of the most missed questions along with the number of instances of no/partial credit associated with them. "Most missed" refers to 20 or more students not receiving full credit.

```{r TABLE: Most Missed Questions, include = TRUE, echo = FALSE}
table_mis <- matrix(NA, nrow = 12, ncol = 3)

table_mis[1, ] <- c("True/False #1", "1", data_mis[1, ])
table_mis[2, ] <- c("True/False #7", "2", data_mis[7, ])
table_mis[3, ] <- c("Multiple Choice #20", "3", data_mis[20, ])
table_mis[4, ] <- c("Matching #2 (Part 2)", "5", data_mis[36, ])
table_mis[5, ] <- c("Matching #5 (Part 2)", "5", data_mis[39, ])
table_mis[6, ] <- c("Matching #7 (Part 2)", "5", data_mis[41, ])
table_mis[7, ] <- c("Cost Evaluation #3", "6", data_mis[47, ])
table_mis[8, ] <- c("Adverse Selection #1", "7", data_mis[48, ])
table_mis[9, ] <- c("Adverse Selection #2", "7", data_mis[49, ])
table_mis[10, ] <- c("Adverse Selection #3", "7", data_mis[50, ])
table_mis[11, ] <- c("Essay", "8", data_mis[51, ])
table_mis[12, ] <- c("Bonus", "8", data_mis[52, ])

colnames(table_mis) <- c("Question", "Page", "Missed")

# View(table_mis)

# Creating the table
kable(
    x = table_mis,
    row.names = NA,
    col.names = colnames(table_mis),
    align = c("l", "c", "r"),
    caption = NULL,
    label = NULL,
    format.args = list(),
    escape = TRUE
)
```

<p><span style = "font-size: 6pt">True/False #6 (Page 1) is not included in the table above because it was voided before grading.</span></p>

## Grading Guidelines

For the True/False and Multiple Choice sections, 2 points were subtracted for each wrong answer.

For the Matching section (both parts), 1 point was subtracted for each wrong answer.

For the Cost Evaluation section, each question had different criteria:

* For Part 1, 2 points were subtracted if the calculation was incorrect (calculated for both groups instead).
* For Part 2, 2 points were subtracted if the calculation was incorrect (calculated for both groups instead).
* For Part 3, 2 points were subtracted if the answer was incorrect and did not apply to the question. 1 point was subtracted if the answer was lacking a component or the answer explained itself well, but did not answer the question as desired.

For the Adverse Selection section, each question had different criteria:

* For Part 1, 2 points were subtracted if the range(s) provided were incorrect. 1 point was subtracted if the answer indicated that lemons would be sold.
* For Part 2, 1 point was removed for incorrect answers for each of the following components of the question: Yes/No identified, price, type of car(s) sold.
* For Part 3, 2 points were subtracted if the calulation was incorrect. 1 point was subtracted if the question was partially correct or the threshold was properly calculated but the ranges were misidentified.

For the Essay section, 2.5 points were subtracted for each missing negative/positive. 1 point was subtracted for a lack of explanation.

For the Bonus, 5 points were awarded if the answer was correct.